// rpg-test minified version
// full version at ./assets/rpg-test.js

var RPG_TEST=function(){"use strict";var e=document.createElement("canvas"),t=e.getContext("2d"),n="v0.1-20210111-924est",o=["Literal Line"],r=768,i=432,a="768px",s="432px",c="#000000",l=!1,h=function(){f.click=!0,setTimeout(function(){f.click=!1},10)},f={x:0,y:0,down:!1,click:!1},d="./assets/itemDrops.png",u="./assets/tilesetMap.png",x="./assets/tilesetGrass.png",m="./assets/click.wav",y={logo:newImage("./assets/logo.png"),itemDrops:newImage(d),tilesetMap:newImage(u),tilesetGrass:newImage(x)},D={click:newWav(m)},g=["#43002a","#890027","#d9243c","#ff6157","#ffb762","#c76e46","#73392e","#34111f","#000000","#273b2d","#458239","#9cb93b","#ffd832","#ff823b","#d1401f","#7c191a","#310c1b","#833f34","#eb9c6e","#ffdaac","#fffff4","#bfc3c6","#6d8a8d","#293b49","#041528","#033e5e","#1c92a7","#c1f9ff","#ffe0dc","#ff88a9","#c03b94","#601761"],b=function(){console.log("rpg-test "+n),console.log("Authors: "+o),e.width=r,e.height=i,e.style.width=a,e.style.height=s,e.style.background=c,t.imageSmoothingEnabled=l,document.addEventListener("mousemove",function(t){var n=w(e,t);f.x=n.x,f.y=n.y}),e.addEventListener("contextmenu",function(e){e.preventDefault()}),e.addEventListener("mousedown",function(){f.down=!0,h()}),e.addEventListener("mouseup",function(){f.down=!1}),addEventListener("blur",function(){f.down=!1})},w=function(e,t){var n=e.getBoundingClientRect(),o=r/n.width,a=i/n.height;return{x:Math.floor(t.clientX*o-n.left*o),y:Math.floor(t.clientY*a-n.top*a)}},p=function(e){t.fillStyle=g[e.color||20],t.font=(e.size||24)+"px Zelda DX",t.fillText(e.text,e.center?e.x-t.measureText(e.text).width/2:e.x,e.y)},v=function(e){this.text=e.text,this.color=e.color||20,this.x=e.x,this.y=e.y,this.width=e.width||150,this.height=e.height||75,this.borderColor=e.borderColor||1,this.bgColor=e.bgColor||8,this.border=e.border,this.run=e.run};v.prototype.draw=(D.click.volume=.5,function(){var e=f.x,n=f.y,o=this.x,r=this.y,i=this.width,a=this.height;this.border&&(t.lineWidth=2,t.strokeStyle=g[this.borderColor],t.strokeRect(o-i/2,r-a/2,i,a)),t.fillStyle=g[this.bgColor],t.fillRect(o-i/2,r-a/2,i,a),e>=o-i/2&&e<=o+i/2&&n>=r-a/2&&n<=r+a/2&&(t.fillStyle=hexToRgba(g[2],.25),t.fillRect(o-i/2,r-a/2,i,a),f.click&&(D.click.play(),f.click=!1,this.run())),this.text&&p({text:this.text,color:this.color,x:o,y:r+5,center:!0})});var k,R,M,T,L,I,C,A,E,S,B,G,z,N,P,j,q,W,F,O=(A="title",E={member1:{class:"Member 1"},member2:{class:"Member 2"},member3:{class:"Member 3"},member4:{class:"Member 4"}},S=["Assassin","Ninja","Nunchaku-ka","Monk","Mage","Gunner"],G=["DDDDDD45A000000000000000000076000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","DDDDDDDD45A00000000000000000B0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","DDDDDDDDDD4555A000000000000760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","DDDDDDD122C000455A000000000B00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","DDDD122C000000000455A000007600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","DDD1C0000000000000004555556000000000000000000000000000000000000000000005555000000000000000000000000000000000000000000000000000000000000000000000","D12C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","DB0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","DB0000000000000000000000000000000000000000005555550000000000000000000000000000000000000000000000000005555500000000000000000000000000000000000000","22223000000000000000075A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","0000930000000000000008DB000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","00000B0000000000000008D4A00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5555560000000000000008DDB00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","0000000000000000000076DD455550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","000000000000000075556DDDDD0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","0007555555A007556DDDDDDDDDDD00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","5556DDDDDD4556DDDDDDDDDDDDDDDDD00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"],z=[{name:"title",tileset:(B={map:y.tilesetMap,grass:y.tilesetGrass}).grass,data:[["000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000","222230000000000000000000000000000000000000012222","555552222300000000000000000000000000001222255555","555555555522223000000000000000000122225555555555","555555555555555222222222222222222555555555555555","555555555555555555555555555555555555555555555555","555555555555555555555555555555555555555555555555","555555555555555555555555555555555555555555555555"]],multiple:!1}],N=function(){var e=function(e){this.joints={shoulders:{x:0,y:0},elbowRight:{x:0,y:0,rot:0},elbowLeft:{x:0,y:0,rot:0},handRight:{x:0,y:0,rot:0},handLeft:{x:0,y:0,rot:0},hips:{x:0,y:0,rot:0},kneeRight:{x:0,y:0,rot:0},kneeLeft:{x:0,y:0,rot:0},footRight:{x:0,y:0,rot:0},footLeft:{x:0,y:0,rot:0}}};e.prototype.doPhysics=function(){},e.prototype.draw=function(){var e,n,o,r,i=this.joints;t.strokeStyle=g[20],t.lineWidth=1,e=i.shoulders.x,n=i.shoulders.y,o=i.hips.x,r=i.hips.y,t.beginPath(),t.moveTo(e,n),t.lineTo(o,r),t.stroke(),t.beginPath(),t.moveTo(i.handLeft.x,i.handLeft.y),t.lineTo(i.elbowLeft.x,i.elbowLeft.y),t.lineTo(i.shoulders.x,i.shoulders.y),t.lineTo(i.elbowRight.x,i.elbowRight.y),t.lineTo(i.handRight.x,i.handRight.y),t.stroke(),t.beginPath(),t.moveTo(i.footLeft.x,i.footLeft.y),t.lineTo(i.kneeLeft.x,i.kneeLeft.y),t.lineTo(i.hips.x,i.hips.y),t.lineTo(i.kneeRight.x,i.kneeRight.y),t.lineTo(i.footRight.x,i.footRight.y),t.stroke(),t.strokeRect(i.shoulders.x-2,i.shoulders.y-8,5,5)};new e;return function(e){!function(e){e=z[e];for(var n=Math.floor(r/16),o=Math.floor(i/16),a=e.tileset,s=e.multiple?randomInt(5):e.data[0],c=0;c<o;c++)for(var l=0;l<n;l++)t.drawImage(a,16*parseInt(s[c].charAt(l)),0,16,16,16*l,16*c,16,16)}(e)}}(),k=Math.floor(r/16)+1,R=Math.floor(i/16)-10,M=0,T=B.map,P=function(e){for(var n=0;n<R;n++)for(var o=0;o<k;o++){var i=e[n].charAt(o+Math.floor(M/16));t.drawImage(T,16*(isNaN(parseInt(i))?parseInt("0x"+i):parseInt(i)),0,16,16,16*o-M%16,16*n,16,16)}f.x>r-100&&(M+=C/2),f.x<100&&M>0&&(M-=C/2),M<0&&(M=0)},L={begin:new v({text:"New Game",x:r/2,y:i/2,width:235,height:36,run:function(){A="newGame"}}),credits:new v({text:"Credits",x:r/2,y:i/2+50,width:235,height:36,run:function(){A="credits"}}),website:new v({text:"More Games...",x:r/2,y:i/2+100,width:235,height:36,run:function(){open("https://quique.gq/")}})},j=function(){for(var e in p({text:n,color:20,size:16,x:0,y:i}),p({text:"a game by Literal Line",color:14,size:16,x:r/2,y:115,center:!0}),t.drawImage(y.logo,r/2-y.logo.width/2,40,217,61),L)L[e]&&L[e].draw()},q=function(){var e={back:new v({text:"Return to menu",x:r/2,y:i-50,width:250,height:36,run:function(){A="title"}}),sr:new v({text:"Stick Ranger",color:2,x:650,y:i/2+25,width:205,height:25,run:function(){open("https://dan-ball.jp/en/javagame/ranger/")}}),lospec:new v({text:"lospec.com",color:2,x:450,y:i/2+55,width:170,height:25,run:function(){open("https://lospec.com/palette-list/pineapple-32")}})};return function(){for(var t in p({text:"Credits",color:14,size:54,x:r/2,y:80,center:!0}),p({text:"• Coding and game engine by Literal Line",x:15,y:i/2}),p({text:"• Sound effects from Dan Ball's",x:15,y:i/2+30}),p({text:"• Color pallete from lospec.com",x:15,y:i/2+60}),p({text:"  (slightly modified)",x:15,y:i/2+90}),e)e[t]&&e[t].draw()}}(),W=function(){var e,n=1,o=[!1,!1,!1,!1],a={members:{m1:new v({x:r/2-225,y:i/2-25,width:50,height:50,border:!0,run:function(){n=1}}),m2:new v({x:r/2-75,y:i/2-25,width:50,height:50,border:!0,run:function(){n=2}}),m3:new v({x:r/2+75,y:i/2-25,width:50,height:50,border:!0,run:function(){n=3}}),m4:new v({x:r/2+225,y:i/2-25,width:50,height:50,border:!0,run:function(){n=4}})},classes:{c1:new v({x:r/2-300,y:i/2+70,width:40,height:40,border:!0,run:function(){e=1,s()}}),c2:new v({x:r/2-180,y:i/2+70,width:40,height:40,border:!0,run:function(){e=2,s()}}),c3:new v({x:r/2-60,y:i/2+70,width:40,height:40,border:!0,run:function(){e=3,s()}}),c4:new v({x:r/2+60,y:i/2+70,width:40,height:40,border:!0,run:function(){e=4,s()}}),c5:new v({x:r/2+180,y:i/2+70,width:40,height:40,border:!0,run:function(){e=5,s()}}),c6:new v({x:r/2+300,y:i/2+70,width:40,height:40,border:!0,run:function(){e=6,s()}})},back:new v({text:"Back",color:20,x:r/2-200,y:i-40,height:36,run:function(){n=1,e=void 0,o=[!1,!1,!1,!1],E.member1.class="Member 1",E.member2.class="Member 2",E.member3.class="Member 3",E.member4.class="Member 4",A="title"}}),begin:new v({text:"Begin",x:r/2+200,y:i-40,height:36,run:function(){o.every(Boolean)&&(A="map")}})},s=function(){E["member"+n].class=S[e-1],o[n-1]=!0};return function(){for(var i in p({text:"New Game",color:14,size:54,x:r/2,y:80,center:!0}),p({text:"Create your team:",color:14,size:20,x:r/2,y:120,center:!0}),a.members){var s=a.members[i],c=parseInt(i.slice(-1));s.borderColor=c===n?2:20,p({text:E["member"+c].class,size:16,x:s.x,y:s.y+50,center:!0}),s.draw()}for(var i in a.classes){s=a.classes[i];var l=parseInt(i.slice(-1));s.borderColor=l===e?2:20,p({text:S[l-1],size:16,x:s.x,y:s.y+50,center:!0}),s.draw(),t.drawImage(y.itemDrops,8*(l+1),0,8,8,s.x-16,s.y-16,32,32)}a.begin.color=o.every(Boolean)?10:1,a.back.draw(),a.begin.draw()}}(),F=0,function(e){switch(C=e-F,I=Math.floor(1e3/C),t.clearRect(0,0,r,i),f.x<0&&(f.x=0),f.x>r&&(f.x=r),f.y<0&&(f.y=0),f.y>i&&(f.y=i),A){case"title":N(0),j();break;case"credits":N(0),q();break;case"newGame":N(0),W();break;case"map":P(G);break;default:p({text:"ERROR:",size:48,color:2,x:r/2,y:i/2,center:!0}),p({text:'REQUESTED STATE "'+A+'"',color:2,x:r/2,y:i/2+40,center:!0}),p({text:"DOES NOT EXIST!",color:2,x:r/2,y:i/2+60,center:!0}),p({text:"Actual gameplay coming soon... ;)",color:12,x:r/2,y:i-60,center:!0})}p({text:"FPS: "+I,x:0,y:20}),F=e,requestAnimationFrame(O)});return{go:function(){b(),document.body.appendChild(e),requestAnimationFrame(O)}}}();function randomInt(e){return Math.floor(Math.random()*e)}function newImage(e){var t=document.createElement("img");return t.src=e,t}function newWav(e){var t=new Audio(e);return t.setAttribute("type","audio/x-wav"),t}function hexToRgba(e,t){var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?"rgba("+parseInt(n[1],16)+", "+parseInt(n[2],16)+", "+parseInt(n[3],16)+", "+t+")":null}